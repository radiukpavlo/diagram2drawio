Metadata-Version: 2.4
Name: diagram2drawio
Version: 0.1.0
Summary: Convert raster diagram images to editable draw.io files
Author: diagram2drawio contributors
License: MIT
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Requires-Python: >=3.9
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: opencv-python-headless>=4.8.0
Requires-Dist: numpy>=1.24.0
Requires-Dist: scikit-image>=0.21.0
Requires-Dist: easyocr>=1.7.0
Requires-Dist: shapely>=2.0.0
Requires-Dist: networkx>=3.0
Requires-Dist: typer>=0.9.0
Requires-Dist: pydantic>=2.0.0
Provides-Extra: dev
Requires-Dist: pytest>=7.0.0; extra == "dev"
Requires-Dist: ruff>=0.1.0; extra == "dev"
Requires-Dist: mypy>=1.0.0; extra == "dev"
Requires-Dist: build>=1.0.0; extra == "dev"
Requires-Dist: twine>=4.0.0; extra == "dev"
Provides-Extra: tesseract
Requires-Dist: pytesseract>=0.3.10; extra == "tesseract"
Dynamic: license-file

# diagram2drawio

Convert raster diagram images (PNG, JPG, etc.) into editable **draw.io** files.

## Features

- **Semantic extraction**: Detects shapes (rectangles, diamonds, ellipses), connectors, and text labels
- **Editable output**: Generates valid `.drawio` files that open in diagrams.net
- **Offline processing**: Uses EasyOCR for text recognition, no cloud APIs required
- **Debug artifacts**: Generates intermediate images and JSON for troubleshooting
- **Manual correction**: Export to JSON, edit, and rebuild

## Installation

```bash
pip install diagram2drawio
```

For development:

```bash
pip install "diagram2drawio[dev]"
```

## Quick Start

### Command Line

```bash
# Basic conversion
diagram2drawio convert flowchart.png -o flowchart.drawio

# With debug output
diagram2drawio convert flowchart.png -o flowchart.drawio --debug-dir debug/

# Manual correction workflow
diagram2drawio extract flowchart.png --out-ir diagram.json
# (edit diagram.json to fix any issues)
diagram2drawio build diagram.json -o flowchart.drawio
```

### Python API

```python
from diagram2drawio import convert, extract, build

# Simple conversion
diagram = convert("flowchart.png", "flowchart.drawio")

# With debug output
diagram = convert(
    "flowchart.png",
    "flowchart.drawio",
    debug_dir="debug/",
    min_shape_area=150,
)

# Access extracted data
print(f"Found {len(diagram.nodes)} nodes")
print(f"Found {len(diagram.edges)} edges")
```

## CLI Options

```
diagram2drawio convert [OPTIONS] INPUT_PATH

Options:
  -o, --output PATH          Output .drawio file path
  --debug-dir PATH           Save debug artifacts to directory
  --compressed               Compress diagram content
  --min-shape-area INT       Minimum contour area (default: 100)
  --snap-distance INT        Edge-to-node snap distance (default: 15)
  --ocr-confidence FLOAT     OCR confidence threshold (default: 0.4)
  --no-ocr                   Disable OCR
  --no-arrowheads            Disable arrowhead detection
  --verbose                  Enable detailed logging
```

## How It Works

1. **Preprocessing**: Load image, normalize, and binarize
2. **OCR**: Extract text regions using EasyOCR
3. **Text masking**: Remove text to isolate shapes
4. **Shape detection**: Find and classify contours (rectangle, diamond, ellipse)
5. **Connector detection**: Skeletonize and trace lines
6. **Arrowhead detection**: Identify directed edges
7. **Association**: Connect edges to nodes
8. **Label assignment**: Associate text with shapes and edges
9. **Export**: Generate draw.io XML

## Requirements

- Python 3.9+
- OpenCV
- scikit-image
- EasyOCR
- Shapely
- NetworkX

## License

MIT
